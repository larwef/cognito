package client

import (
	"encoding/base64"
	"math/big"
	"testing"
)

var srpTestTable = []struct {
	a            string
	k            string
	xA           string
	userPoolName string
	username     string
	password     string
	timestamp    string
	salt         string
	xB           string
	secretBlock  string
	signature    string
}{
	{
		a:            "d77141184757d236e8e067054932c3335f59b24f44b27236274ea757929f709c51ab0095fcdf7d0a47519b1292a31e9e2f98d6510ecc70d4d40bfbc5d1fb02ea3e3dbac845702f29b69de7cb16adf13aa3866622fe4bacc15b9eab7dca1f6ff40f053eab95c31d7177418bf2b790a01403624d1923c509f902189fa31599a403334a4cdcf144f638dc46849862b17363cbc727c3e83da7024b543421f683da360aa9ccde8c7108c508cf417a69e92709da4eb58191236a620bf6057a29deaf71bc9b805376c567fe3907b971ed9dc1b159cb3bbfea490f52afbfef6e0b5f85d7bee569880cf95af39b3ebbc0f676647f9a7f2609ac21b2b26c1c22d21fdea95730ba7e7aa7765b1f5d51c77f0cbbd24bcce4c40161a96c7e4e6b3cf017f3b3f1c8d1c127ae111c422dd60b44cb3badfc84b70a2347a675b0fac3c8a954a502f778b58b5da76ae54ee0a4b6c963fefc5edda8ea5e866a28c57b4ecffbb0d5703c5a930721d02ed01e612816a58d75ecd88d29180393ab7ad25502fc6573fa4be4",
		k:            "538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6",
		xA:           "45d6bbb2c6a074f73bc9e6e59dccd4992e5ee2ba19230578744e4c5248c59f5338f939bd88fa86f9e2cc305cd890ef21a885fdc80282c00a155fe25a500d1db4db622e73bd0bca086ad1d1fd90601e335fa7a7182b143049eaa4790befcdab68a9b897f799424d915c7d4552db82216aea95b3f0f4a1f41ce4392e0da5b703369dff9aff6c6e37916c7528cff5787b0829e9570b8e9df77b6a434164d80c3dfe05673c1fe0159c13b4a494531c20c935a48c7828a1daf159c3644e7c4505351a403309f47a66a27a09d3fa54bf58e44d30ababac3c3ab3687109e09b408d8dbe8f7590a3f30344b8fef9ccc64fe0cc14031196e899cd61e6c2d404210d3decccf19a5f01eb88571d74b1740f39764787e6a94a1a7612778cade314438f71580826aa12c296d58e724b24da4f53587c00719f3b4e9065555dd90baf77e13e07b37a18526375657f3f6c40f3b57ca7709038c931719d4100d869149e1132e307bde237da7b47d44e561d8bc0cd86b7d01d4292a56470a6d11117984bf0861d5d9b",
		userPoolName: "yepGFqSiu",
		username:     "testUser",
		password:     "Password123!",
		timestamp:    "Tue Apr 16 08:43:29 UTC 2019",
		salt:         "3541a780cb7ab335122f2fd7614fc96c",
		xB:           "b065ab5c4c4947f93dab03a7687601ec4f23cda3949c950886d3a555072fd62d8da9c73906e45ff944ad4163607f537c86ef90b5d387dd6c5d2a6c7031947bc8cc255e58358010ee7c617c64192639bbe5ae7de71a4b9494258783290ba6692b20b3864a460c041c9cca582b6a2135dc79038a0c43412b0d05350996f3efc7ccdd98e10bfa9c3b4c936f9076756d2971785003f17ed48e51ea1731470f9f6f8240a41fb81fb264e84bf62a63640390e637e046e176698b6b67e1dae6f571f80662346f5dfc09577848c0bba8f00335ba1a4c449a752566c8ed6855f21efbc567cc17e5761fae297ea288a3198068845a973587faaefe04b1ebb8091753d0385889e9cc9b7e8d4f6b50fc690c210dd54261706abd202eca32e14eb7e5c435bd3441ef0b8786641883b8273e96cbc0009025e31f4830610f0a322244bfb90133b9d886c7a6a96f494c16c9e624e56fece5e1920f832b59b88001e021b90c88e142f8c7aa40a7f2498477649afe3a9f54fdda79ae42a756d44cb880824a9e050e96",
		secretBlock:  "ut8rxqNX1ibqlO9/K0HdC2bW8VdLuvY3ejFZJhYqaj8ZUdgVmvOo/Uboc7hUhqr5J4X5tipOxaXOtpszRFbZzfs+P9CpAsETtJXp/R2YkYQlMtGro8z3WIuC3HUMxPBiZKQgc8K1HvCsCWJJl/GZzz/tyKvf61GPzbOk7fUmsCpGRFXh8SApLV4LD/bcADsZfF/lLvdM4G2anxfcVYFpJdqEhd4/hnC0jDbw+tRaftOiYu5fm7+HhniZad7VwxgDSD28aCyiQm7Nw4b4UvqwaRt/Zt5T/B0QEpvJseMC6x+96AzYdJ7YHbIV01GP1FZAoCS8RxVmGAYut8RR8N549q8jw0Bj/4fjAzOqQI9oTfBYAUqDLYUpFDsoj7RqaN0QEtO846XuLJM7tThUHwSCqwwDw6zTT/u/lL3apMPKkPvJjPRrHpGsW2H4PBI/FxPAgM6x/wQ36+u1/1OqcuQPK2fdPOiQr43uryTcJ8jWiuucr4PA8FcL8RIUx9U59/64fIz2jiVPywUExMK3+QCTRR/IZZO7Of4KWutFvh2EjIjdhDqhBqgwrJX4pmkVMXPHEcJiOwkFS+2WfOfj2lK5G1M5g0f/1QOffFzyfaA5/xv99Z5G/ldw+Jr1AtS9fkdzkCM89xYL/3bY2/5GH/hKywG/6U5xh1DjbaxaBX2ySI0HK6TN9XIw0Wts9S0eewHJ+0opvVwBhsY8Jo1K3vjlWqU1CYVqwB1OWbPyfdrkVVEiK+AinKWxflODz7IL3FBn1ZWRgN0PV/IxFV9jzqPbw/L+2WhvwhqgPC6twnEgQ4rn2F5DhmrJ61bhUEAmNfSkA9VJmTGCV702bMZT2QUldsdMC+U3S0yx22A/xIiuChOSabNlZdcHfQ/EhHydoA1KEA0X/vkvctM/nIF4x2+HOH2fiP2cyyX8BCd2J5dciWbEOE90L+rWWXCdJP2Juu684z85OMJ9XX6+k9jh5Llp/DwuOR+9MDhUdR7dpsRNqxfMn/KyMvBqQ7IiLyP8G1eCxR2AL3wFKPJbuc3/CpFg9P+j/ZuR/yRurVFKEDpVUwiblMQonxMO3CiK/6OvXZO0fv9+ECv2SpWSF9wF2EDQF4hbhNEQ+1Az8ZH6zlCNLBxxDyePXAwqKJKF389T/BdV8VK3gCU0Xz3qqcb8o/eLwDuKIX+hJ1eo/pmhPWnttqea75Ls/BMXfcw+eBdSOyIvrHEVM0Ach4SqO0o5O2cbyhf0VbFDYilwJ7kXy5rbkVa2jT4I3YYFI+m8HRwA8eC7dv184W585WtB81Snzd9rwOzYj1Sf5JgeO249kJCU/YIE81nvBRnrrXeNCQGFpbGJFNkvcUQ2htGYw7YvV2i/W70JW+mOJB09YEjD4Cxz6xXzTOGSsVeDWlpdcq7MGa9jU4FLBBBJY1PiUPvYURWwIF6xr1UfZHNU+Fxqjm39bVrDSK82UrDvuF2IWb9vRYDPUlI7PhoilLTjop2NRD7zpvVYLvaZ6OYcCDtkvSHl6NpD23EHnIRoMwU20qyyJRuWhrvXNl0PwK/DJmLR7APCU3cUJu7t3YSTf8MjRA34xKuFbf48aLku/MYb07aDm6PxaMAeI4/8jUqqWBqH3xEkKmVgvPzF/qTJH04H2/jA92oFjjgeBGF5ErPnw/5gKLYYVr+afXu6TlrqUuy0hoLuWFdd9sMWrvXaNYyeLj3ZqLuY9wITOJ6DNvQM",
		signature:    "P+2n9zEdbKkqbh11xRppYgGGns5tkjx3JZTFJxiADRo=",
	},
	{
		a:            "bf897b473a497c5d557345cb6e2a07bad63e44f10a6e6afdbfbcef8426e3effdb130af18a9241657e9171d496fbb5428e627340d02be85f401deb2253b444bb38b2f246159de3638ab689aeddda15cebece9f0f24703712a241b2ea2e2f7ab1a99f770d4df7a5c1f5fc277b938fdf821572fd6331d12d9d4bc6598a66647c8bcd3c9def5066a4f4731b38937b955201bc6e7fd459e3c5c1fdd1a7e1afd96858f33808140f6afed024d940e9b09ec2ccc58afbdce98d612b2c527f1fc222c448057ce811442691393eda227896fc0cf0e638384791fd3877f9f1e1a6c07e8fbfe8cc523b38e47d0597ae4c1df284aeec5b9d753cd2ce2313173512e064ae70c06dd204f188d83636e5f6d9fea4effeb6798bf0185db2c8444e4eb37ff9c3c0f7ae1d928db4fbc65c38e95f0edb2eb1c8047ebcfd72eba6f0876bc0329b3059685b7f58abcc81f8c353364dccf535b0ab5e7a5c8a89951246fa2699106b6884817e98ae17af526b365abf30e5672fa16435bb0665ae1faa61bf1840503efc95212",
		k:            "538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6",
		xA:           "89a4bd056c347da6d9b8b74c3cf2429e24742271ac0386e015b1aa5fbcb6c2266f0f338c4005cce5c08503f1d662a6279a2e619801119a48ec89009a7666dfb77f8b5bb872ae5220f0d99e3fda04e2467fd0691f3d0a7b9b1db31393a82c92ecbf12aa3b6d07d7e2abd93e9fd5c2e94517632bfd44a6fc5f4483cdf46e5646ff04e927e8791fe3badba00ab91cb31fb4eabccf0c6a289196460e02f2ce9130bd8cbe9df93d7ed74c9dcb69c51a545bdab3d047b4591efd78b93597dd3112304989383c5f3f1e366ef5b90a9823f137e328a1ba62ddba6044e394701559f7c7e8b94df567d739d7e3e5a331f3aec8c8c18ccacb67332e2355681ae6e6d29fc934f9fec3733d16fe25a829d8e4acc7738fcc38986b891c2c1296d838153ea8301aebef94db2750d32dc2c4821f0dd7c7be892e15ab4d1d69bed1c7f520ff8aab60ceaffbc1768782ee0523473a80e8476d7a2f66fbd774bb71a5693a07e7d38af29df99d57b3e300a24897aef43b690855d165038a185c1d4e71deacc6bc80b412",
		userPoolName: "yepGFqSiu",
		username:     "testUser",
		password:     "Password123!",
		timestamp:    "Tue Apr 16 08:43:30 UTC 2019",
		salt:         "d51034780fe5b2636b0830d931e78f07",
		xB:           "be92be819db30aa80031c72b22304c00d4d5eb0d0b7716da6a0c915c22883ebc74ec78474814ce530dfc892442643f9e864c456333ae0f4df1784601cb7c986300bcaa87d967d69a14b0b1196caee57586c64d819d3c8a8a32e7cb94fdb762ca4889d93ddffb09fb0d6e4e115082ac8ac2c3ed479215b5b74d837c75f27fc22a29ce2fa833f57c3f0749a24b78ef0ae2c7c36246bc74d71d92d5e0537665c4dc122d6459d55695f11b4ac4769fc67efee164f4c62fb0b351b2c5f42d9289631578940a5bbc738eba24a4b182dffc7650be396c0ec7adad2d1af1b0f11b0b7f3f7c385e36162e2c3ab2dacf9304733edf594f4dbaa6af0712f7cf4f4376321e46c7a7d49ca0e77cf85545eeda8dc9dfb55170e44d4bbb8386df467a7f37c4d063e317ba79393dfa4b0c4975992269dec0a4700b69e90aad5ff096f3a5d3681a14b0442d82d848efe099d3e1af119a1dca54cbbc47f58e125bf788160328776d30ce3794b66e425817188a58b588f46a088c08d21470ea3b4165440fb1147f3668",
		secretBlock:  "3AYqdPxBI0/16D9Qah4zPCXwtvLTqCGQgbVmw1yXniwtNFnODEor0s/0EYJhSybg5353uAVIanoAQiqRWJID5wSR4YkgKQoS3JfWBqs6cuAvati7/V45O6kET0cz+r2RiLe4WnOlohZR7mvICALuRqcbY+e9/dnYbxxbaBFW3bpqEvLBBRSVuguRnD79Dz6Hp/cYJik9pU87sZ3DDOMozr3w7FlXlztDV/2gEFXSa1S46r//kdgwonc6RYOG94E8fvB4T/CHfln6HK/88L6JFUd4WP4i3vA7CaP4UvKhA/UiNwUj2KDzLvX0mKmnFILDc2SA/w8nh4f+YiFZykaxWJRXUW2uKkmyRxZWm9jSVQ2hRX5VakAOTddmLg2RsNOVTF+RNVttX97kYlbUBwICE+r20DCWWRCIsGmiCtlV1fgsffN0Py4FAR3mYq19squJUpK8T0wP+uj+FxoqmfZ+iamTeifZWNZ4s/5Kf1NvVkXmxlEBO18eshPVJo/56F5Me8Y8jHyMo4UpYPnuPXCQfMxPuAS6baNz4OmwIqRsl+0sAR0JLJt9hoQ0sNILBaSw0cvU3CCSU0lBp16NGi5vljAQ5kq8oMyswYE5D95kSBH2UQHSwt63bcI7azGez9aLvO/OLSpyrJxT1SniQKLVdGcbyrQodoEwaUXWkPLa8mtEi98K/iCUl/hbIBS/N0aZVMezPeL70/ChECaPIorAotU0lTd+yK7uhAOoqDuo2w8pq8pLvFxwFCQBBqln3NuSxe2f48eWloQxuFmcRgxrS1Bly4Rxr+Q4am7Yl2VA8407ldgq8pLf6xhy8p87nA2fSCJHjP7nM4moFtXFfHCb7w7zQvx/EONaTQzO/9X6uPbKpIj7ZbzBgU2CI/d8uUtv9bSDPGqiViHw0LLg5GXi60rvyFl7pV5LCG6jHxtBjQ07opr5tIlWDGZ9r2w5gSOSpjxaNmnw75oNMuGfMjZEwMAovZTvkJtUCai0XGl4Z6hR0nTaCPZpPGZWKrAsWk0scTCyYi0Z3NFGQqVLRMN6qd3Qv1frdDREVyisDF8NT58Qwm2QrGJQr30fy9aMYTWG3ZH7+NxaPtgj/5W4VqO9IQaYRr24uY1aHh3gnqCqG7zUrp+8roaDX7ZMQI0w+SCT49Vzip1fYushnRY9CTILegb3NcV6+zCbbzoxAjJ4dQ5Xn+r3qvBPokgXMHcqJBJ+iH25oDmif3L7AZEaOgxGCEAH1FajrZcZScjoZ2AZ19xzv8nkq5VsVhmfQ2OL2fUAb60ICR/ZeewR6x+gC53ncjlJgNlilhLhLN7dk+ZXXuO5HXtdd6LuTh7TQgwzJJq4Teoc0SvxXXCypWni6nkPp9iWGiRd5caUmKQm3srqwVeyuh3TC24RNxxAT4zqG/nF1VhzHUeAUXi4OoXsyuqBtaYqBqLMmkH0Zhrb0XOC1RRC0Hpt/7lzyIC/p3yZWqqdX/cReRIBlVFB2msaQIDXUFFQ2G21k71UnsvLEk0z92EKJjwnKi92jPMC6OMSOnuAZdnYwqzIZc8fdMaSFtLpT1fFyjpI4/fsnDcVX4QzjletINOgV1r1yKuiqpRzdQ7k2OWNMaLITUNKf/2mosZf8T8UsR6WuQysi5O0wiyUmFEVyQ5qxAyX+1vJO679Hm9XiUsOR507FBhbt9Dlq3A3omUgC5xnglPHz4nCXQZ56X0djqoeiqfKIOdAXQ==",
		signature:    "Qp4GqSUgjbpvDl7gD9bcbEv6BXn58Ca3XkxD2tJK0sE=",
	},
	{
		a:            "7e6a4b7d6eaec1342b3e8186adf5fbb743fcf0d66235def81e53e65935b5ae6bfd0a355921df24b7be4b8aae619573333d7c921d272afc134d4cbeaa2d71408c5cafa368846b86d5f5a0a592c29140f49ca041f78ded8cedbe89afc83b1489d148fa2dda132a1f2ffb921d6c134704005f4f4da709234bd2d8193303d0606105cae85f04647d091f2b28162b334d63c8876f54124c80d7d4fba235f5e3523ec60a0f004bb4b767fa72b040735749e8a9dfdb50ea79b121d0a879ad01a05a6c04dcf1f8962223884813046948c5633648056e844bc1a418b6ef8e968fed2f2633539c4ad906449893dff4b3b1b47ee597ad769c8d913889951d96c1db74fccb6bc4f489289195b503ff40489670b95e90cda79a914fbe179a6a925dbb88a21f84485636c46be4de81dc193c15238844f21f30b77bf02a6f30a6f3ac37939d5b406fab5780d013843ad42f1e2478792debdc99a2ee014d64947de152a25c45f96383fbcea95bc16554dc39fdc6cde9427b42f6604f154f52090617dc4d897684a6",
		k:            "538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6",
		xA:           "d7ad97d6d786d77b19020ea095651517fe299f5f5c9aaf68362883cee8ad7536994f9c51c2ade9a969feeb2034429991858c75bfe0c6f775c2fc625d915c1f50f180d8fbfb222171166137d4b1d98b43b5d7ea2404c9646ed9ca0cff665cd1e49b3bb8e71c9710c813f7b399dc9aabb8154a167311789f9df729cf7608a1c38796c86d798a51ca519db11ffbcd4bd827083c2d3373844c01a0eba4690acb717050d9dfe20568672930ab6f8a189a38fed247b066d6a93428470bcc18f1532a068da705ea5490d6befaf77c31604d6050302ec538e82daff32c59eebfde52b83cbecd85279bd1cd596b389bb26637778d43200195806e3d1d3be1d09c46193bed5bcd042fe53e3d63f67a9379a1b0decc1388196656bb0e8d7895f323fd9c180af88f7557f40bececa4966982e1d91775fb3d5ea2cfdcc6a2c79fa5d16e21f343d1684bc36a4f68be95e129509f72a3fb5fa3a4432232b3524894bb63a5d5a0f88a70dca73aa545084f846ade736ac54b7ddd7fe5f29ac0f94e6178a9110c966",
		userPoolName: "yepGFqSiu",
		username:     "user1",
		password:     "BlueWall2019#",
		timestamp:    "Wed Apr 17 08:05:22 UTC 2019",
		salt:         "9ba84c04e2e96a0fe6ac4c6bdf76e243",
		xB:           "c6f267cd7ab856c56c59f70b51a5d95ad7f0699e38e4c892c1a693169c094e7efe264a41de26261c6cd4ef6c166b00bc9e72aee6275ca6c8a85e7eb8db0cae27949f2aab0e6e0bcc31b1e3e8137f6563eccd4b54f6b4de3ffe7339375c123b9ecf699caef70af8ce646c0ad92db0458ee5b852ac4dc6834d640a73a1dac580ca9ce24308212c8179627b22b208e5673d0510fffba2feff2d363f1105f330d08e1e98fc25217bf03a204bac2e41ed9926dab17e6d60d84378e58bb6bd28942fba3740906c69c4311e690ca2e93b6493c7590589ba635e8804efeb363ec4aa24a18f186982ba75a022e60f443a8c11ac055e7af5be1bc110bc19371de3b113e41ccff289b8194ec948ec9fbb24e7c28f4c8a63ebe4da9b6b6a3515dff5dd9a2ad0704dbac20effebb9e6a113fcb9d2ed462f54782a4b56e17a4313cafc8a072e6552a1e11547c1a974cb4df2b4e1e3316ddf9d674ea21e4c91ce035a5b5a9777ab80cb9e948208b1cc644d1ccb0d0236f8676ea143ce5c49e73e2a472f29cea9af",
		secretBlock:  "TTo5ZL1HjIXESE//2tlRtWkTRGYJjjli3O9h3aqrgEqeHGcp9hPyYIKvJbpFv9051FNezK+c7FbIxpRILtD1adD3Q39I2ibNQmCdxFtnLqFJ2a61Y+0aLWOyR17gUXLTW4FoysjooZMr6BMBkKj0BUaebWRxTc0mkdnM0S9K766cWK53j+bpa/ZZXVk+k+cObWA9WiRxSxF/pQDDnBleKqjuQivttekGfuVfdXGNXVyiodh0LjxF/OvYzcMyhBpNvmIJrBRWhxTZQ5IsqeN6RShUH2vvEufpaei13eCQDwObyrZBnllS8kdjePrrVgsNEoTN8JJgYfaNrFLflQQfjnTNMGrpYBby3cperX/CXe+HZv4e+/ZynlJ8j4nubMLEK9fYaSaTN9TF+yCt5EIWCVzUPf36E1klXrRSnRG7SjfsFCznSkNrsX9StqqIS9vlf6KoWIDYyieYCJnwDTGCEde1wPF05Ubz/fCNvKzAvmeB/xqWDBpoEzxWAp/XNxdgCwVHX8jFC9stVpFUhxMbR+LDRKhzCclCVzIAyo2GfR/ABz6ThxZbmb3X42BtnY5u5WqI8+ATY06gDyAs5ksYX8Sft6RvIoBmRL3i83swBDICbX4T3/jsqB+6uDXU3UlY3vzvxumJTqDwUY2PpcriNII0x6tVHa2WR/wuvy7QH39mOEMRqIE16UmXEdbE2MOmgk2kPf60+90wlaW7ek30qrXxxU2dAzH2SnVbPMYarsPeE1mPA91nOKA6wtSiT64TmnoFPmTC52q+CEAOkU0uxx0UeE2ZC+n/zQAzuQUVyEJ6sCfBbELbefnMRwyP01qiZULKHtw8T5qbMRuhUB2HqA9AqKTAFHLkRIoYzv1rjXYViAbCTtCjDqaD6DwXr1BFw0foP0kG1L4sTGlaPpAs9HD1suHzn74ABT1XxzWQcESsGg0QtGiJ0M3q+PH+VvcgldXDwydyW0Yn912BQCFUoiY9nU6HdMd/ov5OkDN2Db52VmhPzKOF1IZFPp9O9QuVo9MDh2C3bkhaV4cFy4D5w068BBIsor+rLCT+008He1ZMjtS/1WMc/RM8DGs4Yns4bFctDMnEiItGBwJmh7eVGcHq8VDPF1TiYBJg9OX96Jc+2ahswja3a36Z0IUR/3F+6T5NUviYkJQWc4/aczMNiIAMNTIcI9T4/DLvjPu4Ma2M4Uv3LGW+5AdBTb59inRGgomIAUV7QExlyuXYLlxwTlMBrVwws1NdmbVhdIo7XwhLNNBPn+wR+PXcApyJkDClgq8pU14PY7Yrv3WuCjFaOIzF58moicOYNwrBnUoTfl7lRmJd+HCygEzNe6LqG2ctBNYuotQv/vcv0JKFEHUVNv7YwaLbZXq+FeDgfbJE0HoEZO6WTRl5dH0liCThMAqKY8+bVvKoI+FK34V5NgRm8ofOAE01sgZBX7g02vFve/nx8iUo3+JC2yt1RazUIjj1IZhVSLNOcr3uUYi7kaKJ16HircjprqIzuQ1gwLfcUq2ePoclujs5F4XqeSgE/shOJAHW02DZOV0n3dc0OA7FOTeXg56AyPIZSJQbbVcXtWxAJosyA6Aj3/X+keJJwT2Dr5Tfs1jLx9UBAIiDHHX6JNjO/mM2//IsKYoT0T4l2yD1BYhgumscRhNjQEeMgvjDlVHuhs0XUaH9jMmO2Ks9dL6BRq8YWdPmRmWsALTUvNORvAhqAe0pF33+ig==",
		signature:    "7Q7RpX47Eb9+I9vj0ztuannWvLRjOaGPbe5V4hkgFGk=",
	},
	{
		a:            "7e3936828036f3a324b54cc6be69e1b8b84e6b91ce912d8390c30fa282351e548c6ebb5c7f2f921611872be3f390ceac76fb3210bd19bc09ee725917454004b115b8b7e9a21a7cf50e2f2c372719bbd38048f548560ff39f002c1350c444fb891c7259024d8b8d36568e7e5ebc2ee4f07a031baa62348d9ee7740a18e59075d4d5e02ccf7d630626808dc3e50ddfdc1dc5860d403317e57764607ce2c294944dc8beeb8b2f555d9ff9675783c38e8e44429b72516775d6add0be5150385a04e60d58b668d94a8ffde854fb0c9566b43743a781683675b08c42cc816f813f6ae4de338a85c53107c6056b4344df4b83971d9d4b19e8c030bc5ccb66715e0f7480218171cf15a1028c3248e7f075d5343ecb0a2ef4b8cb99feebceb908dcb3362a0404b6007e8e73f092e373cc491abc5ec03883bb395d41cee9c3a585c6ffb124f2d0797fdd073a4a58312c1c31eac4932c139d1d66d0cec029d973e51fa3f261390f6872ba3790c53f39f783ab37bb3ac3b9a76bddda072b35e5e5b4b5a6a36d",
		k:            "538282c4354742d7cbbde2359fcf67f9f5b3a6b08791e5011b43b8a5b66d9ee6",
		xA:           "ccb4b2b48ee48950cea68c27119ef2e70f21cc3e09799b881ef5ac742f4e3c3be3c130d33f0d8069dc540c309e68e71ffc4e2989f454cdbc554506007bc9ac64f073b7c36ee5512be32c49a92af0998f9fec17019f4c1ff68b33a167b261a3993a37f6a5b28e7e0fb5c83fe30ad14f33de38046690b93e463dd57bd26732b47e1fcabe8643a98a7e853c9a4aafa7673784b0a8bfb686b08bb71e8f888c0fe1bab57f0a1f4246a980882d0085cecac7ccf920531bfae1dbc43fe614e0580c0d82fe5b00f74e5c9136ece7b87723ef167afdb3a04fc8c09800c09437bad75dd7ac4ef9116a73d18dee0d8be00f14f4eb51e954aacfae07652fd2809e09861dd7ceb4198cb675b6c5d4ba30c3f1112a417b351e00acadd197b677761ab9127f72a0db974dcb00a3080bfee99e6352272110282e40977def22645e5f75cfa49f2bd8a6115bab9d874e55c3c8581a71ff6c1cfbd2dd7ec493ab9da0702c662ff6f90111208342eeb7240ef1fb89c4be6b14a7149125acadba35a51ed55d3cf897a8e0",
		userPoolName: "yepGFqSiu",
		username:     "user1",
		password:     "BlueWall2019#",
		timestamp:    "Wed Apr 17 08:05:22 UTC 2019",
		salt:         "27161c099da055e133d37be84e0aabe5",
		xB:           "cf47601f87727a49d88c9be70637c1939aab091a17235b2e1d150db3727da80e7803ce8c672dca206c65432691e351b55950d5d28409ca0a62b647ff62fed421bf37b06dd4e3bd428ac859fe358165c6755867c1af676670e17556da65ffade8825449acb875a070c1dba94dab93ba34771f9fa642b2b0fcf7d927fbca00153827aa6b32cd9316d80be2a9068fe11c42ad06574c0f04626f5ea9dba6c1ad7df467bf8389c6aa9792010254f509e230f5bc837665ba64b2f45d7b878723df90f7d5b009d1d537e574f9663e0c57b204a6078712d2854871a084c2e3420297a9d6494f4a5709d37667ac0b02e445ad6d9256e6aa058ed9fffcc25126848fee7a2612122f004d0a1f237c6710e8037402d31f0be575255c49fa1500788fa6ff52b32a10c199e1b29ac8577e45a9658a11120b70bcbf3edc3f424dd5b73df2e89f2d8613ed33ce897c7637c39865c10a4ffc79bc503d323bd5ba799f874df4afb6e6a359aa11020c08723b0ee0cd0952806a3585ad658f77858cca475425ea98b7e0",
		secretBlock:  "K4UD6U5NFluhV/vxTnxRNZs/uy0xQZW6AGi5b1J9aw13nj1LkPxEHIObwPRvu+moRK+pu7kZ7UOxOTIWph8LnRlLUd1CWCiwpl7piFsDV3m/Cjkw0tqr6BZQcONt+aD3yKefkRhdKay865oHUMuGtKHc1ZhZX1Gnce6OMmuAp4XiVaWoWiMKlMjbLBRvyAnGjtiV9igWLA/BCKF2auNny1nc6M9JxHsKeX9IsFHbkua3jVrvWUZP8/mhEsO1Lr+yNmbymlIg5s1LHbQ8MvtQID40qLsx3XqVdZBUsKU9y2KtQUK/0WdNs4M2w/nzSRB/koJsjQT6DKlOHQSsycEqb0aH0/Mqs54FtsRsbHX5KbXc78DFUhnhgIHZWroL8H2b0hzLR9jYNzhDOdKYYUMGvYfLAKW3ufKP2A3xQpfz3iSC1/7a3fZrEqcp0BP7rfGbx9gL7Lmcua/r4tHG7q52Hq7Y0LyW5/fslADecGdwIrZZnVp/SvcPhUHHLxlwOj0NedBuGKMCKwRBCTKK2TEpKUNAhlp4viI489e0XxXC4Gt7iDZFtM1StsP2LmLfILWOPMA8VBCYv58yp+AwULZGhZqP+jKN8+fyuPJ1MUA7hQ1M++Ag82cFz7oLtfBmXncRTLnB4OcJc9nZuas0ufSpPjMyDxhgsL193OMPMDOrIrA2VYRJ18aECd12AiA9Sw+gQ4/225eXnpJScbIhvra9lJZevnaPjyDQjdnfkQgeahTE3J7qZBaYOvyrBcfny49+w36+80Y8+mmCAH6tghQdSG2Abb5ojmswxVTKWPQvRRe0qW8aYIC7koO5XeDl8ocLLQ3kmtgkQsNEyhhIaVbYZ0wyaLlIhlfd5FfJ9Bff/4gESy43s6WAM8wjwWQtMDTEBPlHvah11WYigARLGr1d2t/6rD1G2wgG7PzyL2C4cnywMK26ExdxqE5BJXHDH3sWE1gH193xNqh4tSsQxx7KmspywnM/nU+iaRMpcJR1WF2Ddcyl70ANpEBjaMA005Wl47b5oNY0wd558jaaDUiroAQ/jO3WnRyNKGfQOKRJgWmd30pnhSyMCl1jIuW+UOxfiZc8TRcreL4Rtw3AQwvSYz1fVWZ6oQfdoGnfEtZe/XkaTVOwWgH7ZAJPD3Im+rNNzQe5cdgNaoUGKa0faA86u88wcbkbvW1vaHhOHBOqYUpcHp+jHY7fhjjUc2f1QcA/MDrXQR4txKOwAgdQFB9gNC6IBMLCx7CI+AVe/bmjclJPhh6BvfdAWcl1WjUYBMlopwXep/uZkeCdT2FNyWP8NknlwYSjljIU8J87dQR8UncgZLNu2jYdwjBMGuksMXgrYC98Dm5buQuJMTGqo9+bhxaw+Bcx1RU4A1hUeWNeUQi/iIYIrnPs5tmBK8L0uOI+Z+whLlutQB1M1iVB86b7+HPz7iwEjaaJrCXRfUmW/AS5nfznymHbKJSD862c6CJRLBXMLx3vqMLZ+IOPm4CnJs4WsHC17dco02UeZIrNAdW6SCGCs+7qfMHVj81Lf1Q/GY2Q1bGHpQwfYOQ6MTyMIzWz9BGG0ydQvfmdKLazOH5yQxHRz3USB3hD/yTYmzF5ULQ2zXHeUFv/Q90mQ/rpRgx4QOxDi7hFS6BQm58QYpiBQaBu1wLvx9dzDOwm8TNPOYnV/aFmkOQGCZyeStbLfAG8gXTT+Balfa6Eirn0Sj8+qH381pLKxBmC0g==",
		signature:    "bHCDFj4gcvyg7mH0ZSweOUFy3H+XmkSco2fbV/tVPV0=",
	},
}

func TestSrp(t *testing.T) {
	for _, elem := range srpTestTable {
		a, _ := big.NewInt(0).SetString(elem.a, 16)

		s, err := newSrp(a)
		if err != nil {
			t.Errorf("newSrp returned an error: %v", err)
		}

		if s.k.Text(16) != elem.k {
			t.Errorf("k values not equal. Got: %v Expected: %v", s.k.Text(16), elem.k)
		}

		if s.xA.Text(16) != elem.xA {
			t.Errorf("A values not equal. Got: %v Expected: %v", s.k.Text(16), elem.k)
		}

		salt, _ := big.NewInt(0).SetString(elem.salt, 16)
		xB, _ := big.NewInt(0).SetString(elem.xB, 16)
		secretBlock, _ := base64.StdEncoding.DecodeString(elem.secretBlock)

		signature, err := s.getSignature(elem.userPoolName, elem.username, elem.password, elem.timestamp, salt, xB, secretBlock)
		if err != nil {
			t.Errorf("getSignature returned an error: %v", err)
		}

		if signature != elem.signature {
			t.Errorf("signature values not equal. Got: %v Expected: %v", signature, elem.signature)
		}
	}
}
